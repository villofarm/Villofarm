{% extends 'skyvite/base.html' %}
{% load static %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">

{% block content %}
<div class="page-wrapper">
  <div class="container-fluid">

    <!-- Page Header -->
    <div class="d-flex justify-content-between align-items-center mt-4 mb-3">
      <div>
        <h3 class="fw-bold">Add Circular</h3>
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb mb-0">
            <li class="breadcrumb-item"><a href="#">Dashboard</a></li>
            <li class="breadcrumb-item"><a href="#">Web Admin</a></li>
            <li class="breadcrumb-item active" aria-current="page">Add Circular</li>
          </ol>
        </nav>
      </div>
      <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addCircularModal">
        <i class="bi bi-plus-circle me-1"></i> Add Circular
      </button>
    </div>

    <!-- Circulars Table -->
    <div class="card shadow-sm">
      <div class="card-body">
        {% if circulars %}
          <table class="table table-striped align-middle">
            <thead class="table-light">
              <tr>
                <th>Title</th>
                <th>Description</th>
                <th>Posted Date</th>
                <th>Valid Upto</th>
                <th>Published</th>
              </tr>
            </thead>
            <tbody>
              {% for circular in circulars %}
              <tr>
                <td>{{ circular.title }}</td>
                <td>{{ circular.description }}</td>
                <td>{{ circular.posted_date }}</td>
                <td>{{ circular.valid_upto }}</td>
                <td>
                  {% if circular.is_published %}
                    <span class="badge bg-success">Yes</span>
                  {% else %}
                    <span class="badge bg-secondary">No</span>
                  {% endif %}
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        {% else %}
          <p class="text-muted">No circulars available.</p>
        {% endif %}
      </div>
    </div>

    <!-- Add Circular Modal -->
    <div class="modal fade" id="addCircularModal" tabindex="-1" aria-labelledby="addCircularModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content shadow border-0 rounded-3">

          <!-- Modal Header -->
          <div class="modal-header bg-primary text-white">
            <h5 class="modal-title fw-bold">
              <i class="bi bi-megaphone-fill me-2"></i> Add New Circular
            </h5>
            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>

          <!-- Modal Body -->
          <form method="POST" action="{% url 'manage-circular' %}">
            {% csrf_token %}
            <div class="modal-body">

              <div class="form-floating mb-3">
                <input type="text" id="id_title" name="title" class="form-control" placeholder="Circular Title" required>
                <label for="id_title">Circular Title</label>
              </div>

              <div class="form-floating mb-3">
                <textarea id="id_description" name="description" class="form-control" placeholder="Description" style="height: 120px;" required></textarea>
                <label for="id_description">Description</label>
              </div>

              <div class="row g-3">
                <div class="col-md-6">
                  <div class="form-floating">
                    <input type="date" id="id_posted_date" name="posted_date" class="form-control" required>
                    <label for="id_posted_date">Posted Date</label>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="form-floating">
                    <input type="date" id="id_valid_upto" name="valid_upto" class="form-control" required>
                    <label for="id_valid_upto">Valid Upto</label>
                  </div>
                </div>
              </div>

              <div class="form-check mt-4">
                <input type="checkbox" id="id_is_published" name="is_published" class="form-check-input">
                <label for="id_is_published" class="form-check-label">Publish Online</label>
              </div>

            </div>

            <!-- Modal Footer -->
            <div class="modal-footer">
              <button type="button" class="btn btn-light border" data-bs-dismiss="modal">Cancel</button>
              <button type="submit" class="btn btn-primary">Save Circular</button>
            </div>
          </form>

        </div>
      </div>
    </div>

  </div>
</div>
{% endblock %}
